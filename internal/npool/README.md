# Что это?

Это пул объектов, к которым возможно обращение по ключу. Ключом может быть всё, что может быть ключём map-а в Go. Технически это sync.Pool, перед которым находится map.

# Зачем это?

Для создания реестра объектов, которые имеют собственный жизненный цикл. Пока объект активен, он доступен по ключу. Если по ключу нет активного объекта, то из пула достаётся неактивный и активируется. Объект сам решает, когда он становится неактивным.

# Как это?

    // pool = npool.New((*myObj)(nil))
    pool = npool.New(&myObj{})

    obj := pool.Get("key").(*myObj)

myObj должен иметь интерфейс npool.NewWakeupper

    type NewWakeupper interface {
        New    func(key interface{}, sleep func(), conf interface{})
        Wakeup func(key interface{}, sleep func())
    }

Объект, переданный в функцию New является шаблоном для создания новых объектов. При создании нового объекта

Если в пуле нет объекта для активации, то создаётся новый объект и у него вызывается метод New. Этот метод должен инициализировать объект, как ему нужно, и сохранить функцию sleep.

Объект должен вызвать функцию sleep, когда он будет готов стать неактивным. Желательно при этом очистить ссылку на эту функццию в объекте.

Если в пуле есть неактивные объекты, то берётся один из них, и у него вызывается метод Wakeup. Этот метод должен привести объект в начальное состояние и запомнить новую функцию sleep.